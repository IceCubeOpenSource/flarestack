
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Welcome to Flarestack’s documentation! &#8212; Flarestack 2.0-beta.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="welcome-to-flarestack-s-documentation">
<h1>Welcome to Flarestack’s documentation!<a class="headerlink" href="#welcome-to-flarestack-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="base-pdfs">
<h2>Base PDFs<a class="headerlink" href="#base-pdfs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-flarestack.core.time_pdf">
<span id="time-pdfs"></span><h3>Time PDFs<a class="headerlink" href="#module-flarestack.core.time_pdf" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="flarestack.core.time_pdf.Box">
<em class="property">class </em><code class="descclassname">flarestack.core.time_pdf.</code><code class="descname">Box</code><span class="sig-paren">(</span><em>t_pdf_dict</em>, <em>season</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Box"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Box" title="Permalink to this definition">¶</a></dt>
<dd><p>The simplest time-dependent case for a Time PDF. Used for a source that
is uniformly emitting for a fixed period of time. Requires arguments of
Pre-Window and Post_window, and gives a box from Pre-Window days before
the reference time to Post-Window days after the reference time.</p>
<dl class="method">
<dt id="flarestack.core.time_pdf.Box.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>t_pdf_dict</em>, <em>season</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Box.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Box.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.Box.effective_injection_time">
<code class="descname">effective_injection_time</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Box.effective_injection_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Box.effective_injection_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the effective injection time for the given PDF.
The livetime is measured in days, but here is converted to seconds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> – Source to be considered</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Effective Livetime in seconds</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.Box.flare_time_mask">
<code class="descname">flare_time_mask</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Box.flare_time_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Box.flare_time_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>In this case, the interesting period for Flare Searches is the
period of overlap of the flare and the box. Thus, for a given season,
return the source and data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Start time (MJD) and End Time (MJD) for flare search period</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.Box.raw_injection_time">
<code class="descname">raw_injection_time</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Box.raw_injection_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Box.raw_injection_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the ‘raw injection time’ which is the injection time
assuming a detector with 100% uptime. Useful for calculating source
emission times for source-frame energy estimation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> – Source to be considered</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Time in seconds for 100% uptime</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.Box.sig_t0">
<code class="descname">sig_t0</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Box.sig_t0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Box.sig_t0" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the starting time for the window, equal to the
source reference time in MJD minus the length of the pre-reference-time
window (in days).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> – Source to be considered</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Time of Window Start</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.Box.sig_t1">
<code class="descname">sig_t1</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Box.sig_t1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Box.sig_t1" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the starting time for the window, equal to the
source reference time in MJD plus the length of the post-reference-time
window (in days).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> – Source to be considered</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Time of Window End</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.Box.signal_f">
<code class="descname">signal_f</code><span class="sig-paren">(</span><em>t</em>, <em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Box.signal_f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Box.signal_f" title="Permalink to this definition">¶</a></dt>
<dd><p>In this case, the signal PDF is a uniform PDF for a fixed duration of
time. It is normalised with the length of the box in LIVETIME rather
than days, to give an integral of 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> – Time</li>
<li><strong>source</strong> – Source to be considered</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Value of normalised box function at t</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.Box.signal_integral">
<code class="descname">signal_integral</code><span class="sig-paren">(</span><em>t</em>, <em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Box.signal_integral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Box.signal_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>In this case, the signal PDF is a uniform PDF for a fixed duration of
time. Thus, the integral is simply a linear function increasing
between t0 (box start) and t1 (box end). After t1, the integral is
equal to 1, while it is equal to 0 for t &lt; t0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> – Time</li>
<li><strong>source</strong> – Source to be considered</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Value of normalised box function at t</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.time_pdf.FixedEndBox">
<em class="property">class </em><code class="descclassname">flarestack.core.time_pdf.</code><code class="descname">FixedEndBox</code><span class="sig-paren">(</span><em>t_pdf_dict</em>, <em>season</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#FixedEndBox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.FixedEndBox" title="Permalink to this definition">¶</a></dt>
<dd><p>The simplest time-dependent case for a Time PDF. Used for a source that
is uniformly emitting for a fixed period of time. In this case, the start
and end time for the box is unique for each source. The sources must have
a field “Start Time (MJD)” and another “End Time (MJD)”, specifying the
period of the Time PDF.</p>
<dl class="method">
<dt id="flarestack.core.time_pdf.FixedEndBox.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>t_pdf_dict</em>, <em>season</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#FixedEndBox.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.FixedEndBox.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.FixedEndBox.sig_t0">
<code class="descname">sig_t0</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#FixedEndBox.sig_t0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.FixedEndBox.sig_t0" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the starting time for the window, equal to the
source reference time in MJD minus the length of the pre-reference-time
window (in days).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> – Source to be considered</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Time of Window Start</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.FixedEndBox.sig_t1">
<code class="descname">sig_t1</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#FixedEndBox.sig_t1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.FixedEndBox.sig_t1" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the starting time for the window, equal to the
source reference time in MJD plus the length of the post-reference-time
window (in days).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> – Source to be considered</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Time of Window End</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.time_pdf.FixedRefBox">
<em class="property">class </em><code class="descclassname">flarestack.core.time_pdf.</code><code class="descname">FixedRefBox</code><span class="sig-paren">(</span><em>t_pdf_dict</em>, <em>season</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#FixedRefBox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.FixedRefBox" title="Permalink to this definition">¶</a></dt>
<dd><p>The simplest time-dependent case for a Time PDF. Used for a source that
is uniformly emitting for a fixed period of time. In this case, the start
and end time for the box is unique for each source. The sources must have
a field “Start Time (MJD)” and another “End Time (MJD)”, specifying the
period of the Time PDF.</p>
<dl class="method">
<dt id="flarestack.core.time_pdf.FixedRefBox.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>t_pdf_dict</em>, <em>season</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#FixedRefBox.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.FixedRefBox.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.FixedRefBox.sig_t0">
<code class="descname">sig_t0</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#FixedRefBox.sig_t0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.FixedRefBox.sig_t0" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the starting time for the window, equal to the
source reference time in MJD minus the length of the pre-reference-time
window (in days).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> – Source to be considered</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Time of Window Start</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.FixedRefBox.sig_t1">
<code class="descname">sig_t1</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#FixedRefBox.sig_t1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.FixedRefBox.sig_t1" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the starting time for the window, equal to the
source reference time in MJD plus the length of the post-reference-time
window (in days).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> – Source to be considered</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Time of Window End</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.time_pdf.Steady">
<em class="property">class </em><code class="descclassname">flarestack.core.time_pdf.</code><code class="descname">Steady</code><span class="sig-paren">(</span><em>t_pdf_dict</em>, <em>season</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Steady"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Steady" title="Permalink to this definition">¶</a></dt>
<dd><p>The time-independent case for a Time PDF. Requires no additional
arguments in the dictionary for __init__. Used for a steady source that
is continuously emitting.</p>
<dl class="method">
<dt id="flarestack.core.time_pdf.Steady.effective_injection_time">
<code class="descname">effective_injection_time</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Steady.effective_injection_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Steady.effective_injection_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the effective injection time for the given PDF.
The livetime is measured in days, but here is converted to seconds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> – Source to be considered</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Effective Livetime in seconds</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.Steady.flare_time_mask">
<code class="descname">flare_time_mask</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Steady.flare_time_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Steady.flare_time_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>In this case, the interesting period for Flare Searches is the
entire season. Thus returns the start and end times for the season.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Start time (MJD) and End Time (MJD) for flare search period</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.Steady.raw_injection_time">
<code class="descname">raw_injection_time</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Steady.raw_injection_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Steady.raw_injection_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the ‘raw injection time’ which is the injection time
assuming a detector with 100% uptime. Useful for calculating source
emission times for source-frame energy estimation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> – Source to be considered</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Time in seconds for 100% uptime</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.Steady.sig_t0">
<code class="descname">sig_t0</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Steady.sig_t0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Steady.sig_t0" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the starting time for the window, equal to the
source reference time in MJD minus the length of the pre-reference-time
window (in days).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> – Source to be considered</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Time of Window Start</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.Steady.sig_t1">
<code class="descname">sig_t1</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Steady.sig_t1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Steady.sig_t1" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the starting time for the window, equal to the
source reference time in MJD plus the length of the post-reference-time
window (in days).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> – Source to be considered</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Time of Window End</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.Steady.signal_f">
<code class="descname">signal_f</code><span class="sig-paren">(</span><em>t</em>, <em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Steady.signal_f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Steady.signal_f" title="Permalink to this definition">¶</a></dt>
<dd><p>In the case of a steady source, the signal PDF is a uniform PDF in
time. It is thus simply equal to the season_f, normalised with the
length of the season to give an integral of 1. It is thus equal to
the background PDF.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> – Time</li>
<li><strong>source</strong> – Source to be considered</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Value of normalised box function at t</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.Steady.signal_integral">
<code class="descname">signal_integral</code><span class="sig-paren">(</span><em>t</em>, <em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#Steady.signal_integral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.Steady.signal_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>In the case of a steady source, the signal PDF is a uniform PDF in
time. Thus, the integral is simply a linear function increasing
between t0 (box start) and t1 (box end). After t1, the integral is
equal to 1, while it is equal to 0 for t &lt; t0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> – Time</li>
<li><strong>source</strong> – Source to be considered</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Value of normalised box function at t</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.time_pdf.TimePDF">
<em class="property">class </em><code class="descclassname">flarestack.core.time_pdf.</code><code class="descname">TimePDF</code><span class="sig-paren">(</span><em>t_pdf_dict</em>, <em>season</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#TimePDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.TimePDF" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="flarestack.core.time_pdf.TimePDF.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>t_pdf_dict</em>, <em>season</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#TimePDF.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.TimePDF.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.TimePDF.background_f">
<code class="descname">background_f</code><span class="sig-paren">(</span><em>t</em>, <em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#TimePDF.background_f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.TimePDF.background_f" title="Permalink to this definition">¶</a></dt>
<dd><p>In all cases, we assume that the background is uniform in time.
Thus, the background PDF is just a normalised version of the season_f
box function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> – Time</li>
<li><strong>source</strong> – Source to be considered</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Value of normalised box function at t</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="flarestack.core.time_pdf.TimePDF.create">
<em class="property">classmethod </em><code class="descname">create</code><span class="sig-paren">(</span><em>t_pdf_dict</em>, <em>season</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#TimePDF.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.TimePDF.create" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.TimePDF.inverse_interpolate">
<code class="descname">inverse_interpolate</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#TimePDF.inverse_interpolate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.TimePDF.inverse_interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the values for the integral of the signal PDF within
the season. Then rescales these values, such that the start of the
season yields 0, and then end of the season yields 1. Creates a
function to interpolate between these values. Then, for a number
between 0 and 1, the interpolated function will return the MJD time
at which that fraction of the cumulative distribution was reached.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> – Source to be considered</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Interpolated function</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.TimePDF.product_integral">
<code class="descname">product_integral</code><span class="sig-paren">(</span><em>t</em>, <em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#TimePDF.product_integral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.TimePDF.product_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the product of the given signal PDF with the season box
function. Thus gives 0 everywhere outside the season, and otherwise
the value of the normalised integral. The season function is offset
by 1e-9, to ensure that f(t1) is equal to 1. (i.e the function is
equal to 1 at the end of the box).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> – Time</li>
<li><strong>source</strong> – Source to be considered</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Product of signal integral and season</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="flarestack.core.time_pdf.TimePDF.register_subclass">
<em class="property">classmethod </em><code class="descname">register_subclass</code><span class="sig-paren">(</span><em>time_pdf_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#TimePDF.register_subclass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.TimePDF.register_subclass" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.time_pdf.TimePDF.simulate_times">
<code class="descname">simulate_times</code><span class="sig-paren">(</span><em>source</em>, <em>n_s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#TimePDF.simulate_times"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.TimePDF.simulate_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly draws times for n_s events for a given source,
all lying within the current season. The values are based on an
interpolation of the integrated time PDF.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>source</strong> – Source being considered</li>
<li><strong>n_s</strong> – Number of event times to be simulated</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Array of times in MJD for a given source</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flarestack.core.time_pdf.TimePDF.subclasses">
<code class="descname">subclasses</code><em class="property"> = {'Box': &lt;class 'flarestack.core.time_pdf.Box'&gt;, 'FixedEndBox': &lt;class 'flarestack.core.time_pdf.FixedEndBox'&gt;, 'FixedRefBox': &lt;class 'flarestack.core.time_pdf.FixedRefBox'&gt;, 'Steady': &lt;class 'flarestack.core.time_pdf.Steady'&gt;}</em><a class="headerlink" href="#flarestack.core.time_pdf.TimePDF.subclasses" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="flarestack.core.time_pdf.box_func">
<code class="descclassname">flarestack.core.time_pdf.</code><code class="descname">box_func</code><span class="sig-paren">(</span><em>t</em>, <em>t0</em>, <em>t1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#box_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.box_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Box function that is equal to 1 between t0 and t1, and 0 otherwise.
Equal to 0.5 at to and t1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> – Time to be evaluated</li>
<li><strong>t0</strong> – Start time of box</li>
<li><strong>t1</strong> – End time of box</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Value of Box function at t</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flarestack.core.time_pdf.read_t_pdf_dict">
<code class="descclassname">flarestack.core.time_pdf.</code><code class="descname">read_t_pdf_dict</code><span class="sig-paren">(</span><em>t_pdf_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/time_pdf.html#read_t_pdf_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.time_pdf.read_t_pdf_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures backwards compatibility for t_pdf_dict objects</p>
</dd></dl>

</div>
<div class="section" id="module-flarestack.core.energy_pdf">
<span id="energy-pdfs"></span><h3>Energy PDFs<a class="headerlink" href="#module-flarestack.core.energy_pdf" title="Permalink to this headline">¶</a></h3>
<p>This script contains the EnergyPDF classes, that are used for weighting
events based on a given energy PDF.</p>
<dl class="class">
<dt id="flarestack.core.energy_pdf.EnergyPDF">
<em class="property">class </em><code class="descclassname">flarestack.core.energy_pdf.</code><code class="descname">EnergyPDF</code><span class="sig-paren">(</span><em>e_pdf_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.EnergyPDF" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="flarestack.core.energy_pdf.EnergyPDF.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>e_pdf_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.EnergyPDF.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="classmethod">
<dt id="flarestack.core.energy_pdf.EnergyPDF.create">
<em class="property">classmethod </em><code class="descname">create</code><span class="sig-paren">(</span><em>e_pdf_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.EnergyPDF.create" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="flarestack.core.energy_pdf.EnergyPDF.f">
<em class="property">static </em><code class="descname">f</code><span class="sig-paren">(</span><em>energy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.EnergyPDF.f" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.energy_pdf.EnergyPDF.fluence_integral">
<code class="descname">fluence_integral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.fluence_integral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.EnergyPDF.fluence_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs an integral for fluence over a given energy range. This is
gives the total energy per unit area per second that is radiated.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.energy_pdf.EnergyPDF.flux_integral">
<code class="descname">flux_integral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.flux_integral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.EnergyPDF.flux_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrates over energy PDF to give integrated flux (dN/dT)</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.energy_pdf.EnergyPDF.integrate_over_E">
<code class="descname">integrate_over_E</code><span class="sig-paren">(</span><em>f</em>, <em>lower=None</em>, <em>upper=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.integrate_over_E"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.EnergyPDF.integrate_over_E" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses Newton’s method to integrate function f over the energy
range. By default, uses 100GeV to 10PeV, unless otherwise specified.
Uses 1000 logarithmically-spaced bins to calculate integral.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>f</strong> – Function to be integrated</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Integral of function</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="flarestack.core.energy_pdf.EnergyPDF.register_subclass">
<em class="property">classmethod </em><code class="descname">register_subclass</code><span class="sig-paren">(</span><em>energy_pdf_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.register_subclass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.EnergyPDF.register_subclass" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new subclass of EnergyPDF, with class name equal to
“energy_pdf_name”.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.energy_pdf.EnergyPDF.return_energy_parameters">
<code class="descname">return_energy_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.return_energy_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.EnergyPDF.return_energy_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="flarestack.core.energy_pdf.EnergyPDF.subclasses">
<code class="descname">subclasses</code><em class="property"> = {'PowerLaw': &lt;class 'flarestack.core.energy_pdf.PowerLaw'&gt;, 'Spline': &lt;class 'flarestack.core.energy_pdf.Spline'&gt;}</em><a class="headerlink" href="#flarestack.core.energy_pdf.EnergyPDF.subclasses" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.energy_pdf.PowerLaw">
<em class="property">class </em><code class="descclassname">flarestack.core.energy_pdf.</code><code class="descname">PowerLaw</code><span class="sig-paren">(</span><em>e_pdf_dict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.PowerLaw" title="Permalink to this definition">¶</a></dt>
<dd><p>A Power Law energy PDF. Takes an argument of gamma in the dictionary
for the init function, where gamma is the spectral index of the Power Law.</p>
<dl class="method">
<dt id="flarestack.core.energy_pdf.PowerLaw.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>e_pdf_dict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.PowerLaw.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a PowerLaw object, which is an energy PDF based on a power
law. The power law is generated from e_pdf_dict, which can specify a
spectral index (Gamma), as well as an optional minimum energy (E Min)
and a maximum energy (E Max)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>e_pdf_dict</strong> – Dictionary containing parameters</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.energy_pdf.PowerLaw.f">
<code class="descname">f</code><span class="sig-paren">(</span><em>energy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw.f"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.PowerLaw.f" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.energy_pdf.PowerLaw.fluence_integral">
<code class="descname">fluence_integral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw.fluence_integral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.PowerLaw.fluence_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs an integral for fluence over a given energy range. This is
gives the total energy per unit area per second that is radiated.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.energy_pdf.PowerLaw.flux_integral">
<code class="descname">flux_integral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw.flux_integral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.PowerLaw.flux_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrates over energy PDF to give integrated flux (dN/dT)</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.energy_pdf.PowerLaw.return_energy_parameters">
<code class="descname">return_energy_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw.return_energy_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.PowerLaw.return_energy_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.energy_pdf.PowerLaw.return_injected_parameters">
<code class="descname">return_injected_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw.return_injected_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.PowerLaw.return_injected_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.energy_pdf.PowerLaw.weight_mc">
<code class="descname">weight_mc</code><span class="sig-paren">(</span><em>mc</em>, <em>gamma=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw.weight_mc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.PowerLaw.weight_mc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array containing the weights for each MC event,
given that the spectral index gamma has been chosen. Weights each
event as (E/GeV)^-gamma, and multiplies this by the pre-existing MC
oneweight value, to give the overall oneweight.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mc</strong> – Monte Carlo</li>
<li><strong>gamma</strong> – Spectral Index (default is value in e_pdf_dict)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Weights Array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.energy_pdf.Spline">
<em class="property">class </em><code class="descclassname">flarestack.core.energy_pdf.</code><code class="descname">Spline</code><span class="sig-paren">(</span><em>e_pdf_dict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#Spline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.Spline" title="Permalink to this definition">¶</a></dt>
<dd><p>A Power Law energy PDF. Takes an argument of gamma in the dictionary
for the init function, where gamma is the spectral index of the Power Law.</p>
<dl class="method">
<dt id="flarestack.core.energy_pdf.Spline.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>e_pdf_dict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#Spline.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.Spline.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a PowerLaw object, which is an energy PDF based on a power
law. The power law is generated from e_pdf_dict, which can specify a
spectral index (Gamma), as well as an optional minimum energy (E Min)
and a maximum energy (E Max)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>e_pdf_dict</strong> – Dictionary containing parameters</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.energy_pdf.Spline.weight_mc">
<code class="descname">weight_mc</code><span class="sig-paren">(</span><em>mc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#Spline.weight_mc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.Spline.weight_mc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array containing the weights for each MC event,
given that the spectral index gamma has been chosen. Weights each
event using the energy spline, and multiplies this by the
pre-existing MC oneweight value, to give the overall oneweight.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mc</strong> – Monte Carlo</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Weights Array</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="flarestack.core.energy_pdf.read_e_pdf_dict">
<code class="descclassname">flarestack.core.energy_pdf.</code><code class="descname">read_e_pdf_dict</code><span class="sig-paren">(</span><em>e_pdf_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#read_e_pdf_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.energy_pdf.read_e_pdf_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures backwards compatibility of e_pdf_dict objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>e_pdf_dict</strong> – Energy PDF dictionary</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Updated Energy PDF dictionary compatible with new format</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-flarestack.core.energy_pdf">
<span id="spatial-pdfs"></span><h3>Spatial PDFs<a class="headerlink" href="#module-flarestack.core.energy_pdf" title="Permalink to this headline">¶</a></h3>
<p>This script contains the EnergyPDF classes, that are used for weighting
events based on a given energy PDF.</p>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">flarestack.core.energy_pdf.</code><code class="descname">EnergyPDF</code><span class="sig-paren">(</span><em>e_pdf_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF"><span class="viewcode-link">[source]</span></a></dt>
<dd><dl class="method">
<dt>
<code class="descname">__init__</code><span class="sig-paren">(</span><em>e_pdf_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.__init__"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="classmethod">
<dt>
<em class="property">classmethod </em><code class="descname">create</code><span class="sig-paren">(</span><em>e_pdf_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.create"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt>
<em class="property">static </em><code class="descname">f</code><span class="sig-paren">(</span><em>energy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.f"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">fluence_integral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.fluence_integral"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Performs an integral for fluence over a given energy range. This is
gives the total energy per unit area per second that is radiated.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">flux_integral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.flux_integral"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Integrates over energy PDF to give integrated flux (dN/dT)</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">integrate_over_E</code><span class="sig-paren">(</span><em>f</em>, <em>lower=None</em>, <em>upper=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.integrate_over_E"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Uses Newton’s method to integrate function f over the energy
range. By default, uses 100GeV to 10PeV, unless otherwise specified.
Uses 1000 logarithmically-spaced bins to calculate integral.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>f</strong> – Function to be integrated</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Integral of function</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt>
<em class="property">classmethod </em><code class="descname">register_subclass</code><span class="sig-paren">(</span><em>energy_pdf_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.register_subclass"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Adds a new subclass of EnergyPDF, with class name equal to
“energy_pdf_name”.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">return_energy_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#EnergyPDF.return_energy_parameters"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">subclasses</code><em class="property"> = {'PowerLaw': &lt;class 'flarestack.core.energy_pdf.PowerLaw'&gt;, 'Spline': &lt;class 'flarestack.core.energy_pdf.Spline'&gt;}</em></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">flarestack.core.energy_pdf.</code><code class="descname">PowerLaw</code><span class="sig-paren">(</span><em>e_pdf_dict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>A Power Law energy PDF. Takes an argument of gamma in the dictionary
for the init function, where gamma is the spectral index of the Power Law.</p>
<dl class="method">
<dt>
<code class="descname">__init__</code><span class="sig-paren">(</span><em>e_pdf_dict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw.__init__"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Creates a PowerLaw object, which is an energy PDF based on a power
law. The power law is generated from e_pdf_dict, which can specify a
spectral index (Gamma), as well as an optional minimum energy (E Min)
and a maximum energy (E Max)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>e_pdf_dict</strong> – Dictionary containing parameters</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">f</code><span class="sig-paren">(</span><em>energy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw.f"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">fluence_integral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw.fluence_integral"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Performs an integral for fluence over a given energy range. This is
gives the total energy per unit area per second that is radiated.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">flux_integral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw.flux_integral"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Integrates over energy PDF to give integrated flux (dN/dT)</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">return_energy_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw.return_energy_parameters"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">return_injected_parameters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw.return_injected_parameters"><span class="viewcode-link">[source]</span></a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">weight_mc</code><span class="sig-paren">(</span><em>mc</em>, <em>gamma=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#PowerLaw.weight_mc"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns an array containing the weights for each MC event,
given that the spectral index gamma has been chosen. Weights each
event as (E/GeV)^-gamma, and multiplies this by the pre-existing MC
oneweight value, to give the overall oneweight.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mc</strong> – Monte Carlo</li>
<li><strong>gamma</strong> – Spectral Index (default is value in e_pdf_dict)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Weights Array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">flarestack.core.energy_pdf.</code><code class="descname">Spline</code><span class="sig-paren">(</span><em>e_pdf_dict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#Spline"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>A Power Law energy PDF. Takes an argument of gamma in the dictionary
for the init function, where gamma is the spectral index of the Power Law.</p>
<dl class="method">
<dt>
<code class="descname">__init__</code><span class="sig-paren">(</span><em>e_pdf_dict={}</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#Spline.__init__"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Creates a PowerLaw object, which is an energy PDF based on a power
law. The power law is generated from e_pdf_dict, which can specify a
spectral index (Gamma), as well as an optional minimum energy (E Min)
and a maximum energy (E Max)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>e_pdf_dict</strong> – Dictionary containing parameters</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">weight_mc</code><span class="sig-paren">(</span><em>mc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#Spline.weight_mc"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Returns an array containing the weights for each MC event,
given that the spectral index gamma has been chosen. Weights each
event using the energy spline, and multiplies this by the
pre-existing MC oneweight value, to give the overall oneweight.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mc</strong> – Monte Carlo</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Weights Array</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">flarestack.core.energy_pdf.</code><code class="descname">read_e_pdf_dict</code><span class="sig-paren">(</span><em>e_pdf_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/energy_pdf.html#read_e_pdf_dict"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Ensures backwards compatibility of e_pdf_dict objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>e_pdf_dict</strong> – Energy PDF dictionary</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Updated Energy PDF dictionary compatible with new format</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="composite-pdf-objects">
<h2>Composite PDF Objects<a class="headerlink" href="#composite-pdf-objects" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-flarestack.core.injector">
<span id="injector"></span><h3>Injector<a class="headerlink" href="#module-flarestack.core.injector" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="flarestack.core.injector.BaseInjector">
<em class="property">class </em><code class="descclassname">flarestack.core.injector.</code><code class="descname">BaseInjector</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#BaseInjector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.BaseInjector" title="Permalink to this definition">¶</a></dt>
<dd><p>Base Injector Class</p>
<dl class="method">
<dt id="flarestack.core.injector.BaseInjector.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#BaseInjector.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.BaseInjector.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.BaseInjector.calculate_n_exp">
<code class="descname">calculate_n_exp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#BaseInjector.calculate_n_exp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.BaseInjector.calculate_n_exp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.BaseInjector.calculate_n_exp_single">
<code class="descname">calculate_n_exp_single</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#BaseInjector.calculate_n_exp_single"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.BaseInjector.calculate_n_exp_single" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="flarestack.core.injector.BaseInjector.create">
<em class="property">classmethod </em><code class="descname">create</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#BaseInjector.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.BaseInjector.create" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.BaseInjector.create_dataset">
<code class="descname">create_dataset</code><span class="sig-paren">(</span><em>scale</em>, <em>pull_corrector</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#BaseInjector.create_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.BaseInjector.create_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a dataset based on scrambled data for background, and Monte
Carlo simulation for signal. Returns the composite dataset. The source
flux can be scaled by the scale parameter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>scale</strong> – Ratio of Injected Flux to source flux</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Simulated dataset</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="flarestack.core.injector.BaseInjector.get_dec_and_omega">
<em class="property">static </em><code class="descname">get_dec_and_omega</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#BaseInjector.get_dec_and_omega"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.BaseInjector.get_dec_and_omega" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.BaseInjector.get_expectation">
<code class="descname">get_expectation</code><span class="sig-paren">(</span><em>source</em>, <em>scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#BaseInjector.get_expectation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.BaseInjector.get_expectation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.BaseInjector.get_n_exp_single">
<code class="descname">get_n_exp_single</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#BaseInjector.get_n_exp_single"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.BaseInjector.get_n_exp_single" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.BaseInjector.inject_signal">
<code class="descname">inject_signal</code><span class="sig-paren">(</span><em>scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#BaseInjector.inject_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.BaseInjector.inject_signal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="flarestack.core.injector.BaseInjector.register_subclass">
<em class="property">classmethod </em><code class="descname">register_subclass</code><span class="sig-paren">(</span><em>inj_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#BaseInjector.register_subclass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.BaseInjector.register_subclass" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new subclass of EnergyPDF, with class name equal to
“energy_pdf_name”.</p>
</dd></dl>

<dl class="attribute">
<dt id="flarestack.core.injector.BaseInjector.subclasses">
<code class="descname">subclasses</code><em class="property"> = {}</em><a class="headerlink" href="#flarestack.core.injector.BaseInjector.subclasses" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.BaseInjector.update_sources">
<code class="descname">update_sources</code><span class="sig-paren">(</span><em>sources</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#BaseInjector.update_sources"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.BaseInjector.update_sources" title="Permalink to this definition">¶</a></dt>
<dd><p>Reuses an injector with new sources</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sources</strong> – Sources to be added</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.injector.EffectiveAreaInjector">
<em class="property">class </em><code class="descclassname">flarestack.core.injector.</code><code class="descname">EffectiveAreaInjector</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#EffectiveAreaInjector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.EffectiveAreaInjector" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for injecting signal events by relying on effective areas rather
than pre-existing Monte Carlo simulation. This Injector should be used
for analysing public data, as no MC is provided.</p>
<dl class="method">
<dt id="flarestack.core.injector.EffectiveAreaInjector.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#EffectiveAreaInjector.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.EffectiveAreaInjector.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.EffectiveAreaInjector.calculate_energy_proxy">
<code class="descname">calculate_energy_proxy</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#EffectiveAreaInjector.calculate_energy_proxy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.EffectiveAreaInjector.calculate_energy_proxy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.EffectiveAreaInjector.calculate_n_exp_single">
<code class="descname">calculate_n_exp_single</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#EffectiveAreaInjector.calculate_n_exp_single"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.EffectiveAreaInjector.calculate_n_exp_single" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.EffectiveAreaInjector.calculate_single_source">
<code class="descname">calculate_single_source</code><span class="sig-paren">(</span><em>source</em>, <em>scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#EffectiveAreaInjector.calculate_single_source"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.EffectiveAreaInjector.calculate_single_source" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.EffectiveAreaInjector.inject_signal">
<code class="descname">inject_signal</code><span class="sig-paren">(</span><em>scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#EffectiveAreaInjector.inject_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.EffectiveAreaInjector.inject_signal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.injector.LowMemoryInjector">
<em class="property">class </em><code class="descclassname">flarestack.core.injector.</code><code class="descname">LowMemoryInjector</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#LowMemoryInjector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.LowMemoryInjector" title="Permalink to this definition">¶</a></dt>
<dd><p>For large numbers of sources O(~100), saving MC masks becomes
increasingly burdensome. As a solution, the LowMemoryInjector should be
used instead. It will be somewhat slower, but will have much more
reasonable memory consumption.</p>
<dl class="method">
<dt id="flarestack.core.injector.LowMemoryInjector.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#LowMemoryInjector.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.LowMemoryInjector.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.LowMemoryInjector.calculate_n_exp">
<code class="descname">calculate_n_exp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#LowMemoryInjector.calculate_n_exp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.LowMemoryInjector.calculate_n_exp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.LowMemoryInjector.get_band_mask">
<code class="descname">get_band_mask</code><span class="sig-paren">(</span><em>source</em>, <em>min_dec</em>, <em>max_dec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#LowMemoryInjector.get_band_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.LowMemoryInjector.get_band_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.LowMemoryInjector.load_band_mask">
<code class="descname">load_band_mask</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#LowMemoryInjector.load_band_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.LowMemoryInjector.load_band_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.LowMemoryInjector.make_injection_band_mask">
<code class="descname">make_injection_band_mask</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#LowMemoryInjector.make_injection_band_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.LowMemoryInjector.make_injection_band_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.injector.MCInjector">
<em class="property">class </em><code class="descclassname">flarestack.core.injector.</code><code class="descname">MCInjector</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#MCInjector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.MCInjector" title="Permalink to this definition">¶</a></dt>
<dd><p>Core Injector Class, returns a dataset on which calculations can be
performed. This base class is tailored for injection of MC into mock
background. This can be either MC background, or scrambled real data.</p>
<dl class="method">
<dt id="flarestack.core.injector.MCInjector.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#MCInjector.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.MCInjector.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.MCInjector.calculate_fluence">
<code class="descname">calculate_fluence</code><span class="sig-paren">(</span><em>source</em>, <em>scale</em>, <em>source_mc</em>, <em>band_mask</em>, <em>omega</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#MCInjector.calculate_fluence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.MCInjector.calculate_fluence" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to calculate the fluence for a given source, and multiply
the oneweights by this. After this step, the oneweight sum is equal
to the expected neutrino number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>source</strong> – Source to be calculated</li>
<li><strong>scale</strong> – Flux scale</li>
<li><strong>source_mc</strong> – MC that is close to source</li>
<li><strong>band_mask</strong> – Closeness mask for MC</li>
<li><strong>omega</strong> – Solid angle covered by MC mask</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Modified source MC</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.MCInjector.calculate_n_exp_single">
<code class="descname">calculate_n_exp_single</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#MCInjector.calculate_n_exp_single"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.MCInjector.calculate_n_exp_single" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.MCInjector.calculate_single_source">
<code class="descname">calculate_single_source</code><span class="sig-paren">(</span><em>source</em>, <em>scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#MCInjector.calculate_single_source"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.MCInjector.calculate_single_source" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the weighted MC for a single source, given a flux scale
and a distance scale.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>source</strong> – </li>
<li><strong>scale</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.MCInjector.get_band_mask">
<code class="descname">get_band_mask</code><span class="sig-paren">(</span><em>source</em>, <em>min_dec</em>, <em>max_dec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#MCInjector.get_band_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.MCInjector.get_band_mask" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.MCInjector.inject_signal">
<code class="descname">inject_signal</code><span class="sig-paren">(</span><em>scale</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#MCInjector.inject_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.MCInjector.inject_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly select simulated events from the Monte Carlo dataset to
simulate a signal for each source. The source flux can be scaled by
the scale parameter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>scale</strong> – Ratio of Injected Flux to source flux.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Set of signal events for the given IC Season.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.MCInjector.select_mc_band">
<code class="descname">select_mc_band</code><span class="sig-paren">(</span><em>source</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#MCInjector.select_mc_band"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.MCInjector.select_mc_band" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given source, selects MC events within a declination band of
width +/- 5 degrees that contains the source. Then returns the MC data
subset containing only those MC events.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>source</strong> – Source to be simulated</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">mc (cut): Simulated events which lie within the band</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">omega: Solid Angle of the chosen band</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">band_mask: The mask which removes events outside band</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flarestack.core.injector.MCInjector.subclasses">
<code class="descname">subclasses</code><em class="property"> = {'low_memory_injector': &lt;class 'flarestack.core.injector.LowMemoryInjector'&gt;}</em><a class="headerlink" href="#flarestack.core.injector.MCInjector.subclasses" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.injector.MockUnblindedInjector">
<em class="property">class </em><code class="descclassname">flarestack.core.injector.</code><code class="descname">MockUnblindedInjector</code><span class="sig-paren">(</span><em>season</em>, <em>sources=nan</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#MockUnblindedInjector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.MockUnblindedInjector" title="Permalink to this definition">¶</a></dt>
<dd><p>If the data is not really to be unblinded, then MockUnblindedInjector
should be called. In this case, the create_dataset function simply returns
one background scramble.</p>
<dl class="method">
<dt id="flarestack.core.injector.MockUnblindedInjector.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>season</em>, <em>sources=nan</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#MockUnblindedInjector.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.MockUnblindedInjector.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.MockUnblindedInjector.create_dataset">
<code class="descname">create_dataset</code><span class="sig-paren">(</span><em>scale</em>, <em>pull_corrector</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#MockUnblindedInjector.create_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.MockUnblindedInjector.create_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a background scramble</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Scrambled data</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.injector.TrueUnblindedInjector">
<em class="property">class </em><code class="descclassname">flarestack.core.injector.</code><code class="descname">TrueUnblindedInjector</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#TrueUnblindedInjector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.TrueUnblindedInjector" title="Permalink to this definition">¶</a></dt>
<dd><p>If the data is unblinded, then UnblindedInjector should be called. In
this case, the create_dataset function simply returns the unblinded dataset.</p>
<dl class="method">
<dt id="flarestack.core.injector.TrueUnblindedInjector.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#TrueUnblindedInjector.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.TrueUnblindedInjector.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.injector.TrueUnblindedInjector.create_dataset">
<code class="descname">create_dataset</code><span class="sig-paren">(</span><em>scale</em>, <em>pull_corrector</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#TrueUnblindedInjector.create_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.TrueUnblindedInjector.create_dataset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="flarestack.core.injector.read_injector_dict">
<code class="descclassname">flarestack.core.injector.</code><code class="descname">read_injector_dict</code><span class="sig-paren">(</span><em>inj_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/injector.html#read_injector_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.injector.read_injector_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures that injection dictionaries remain backwards-compatible</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>inj_dict</strong> – Injection Dictionary</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Injection Dictionary compatible with new format</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-flarestack.core.llh">
<span id="log-likelihood"></span><h3>Log Likelihood<a class="headerlink" href="#module-flarestack.core.llh" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="flarestack.core.llh.FixedEnergyLLH">
<em class="property">class </em><code class="descclassname">flarestack.core.llh.</code><code class="descname">FixedEnergyLLH</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#FixedEnergyLLH"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.FixedEnergyLLH" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="flarestack.core.llh.FixedEnergyLLH.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#FixedEnergyLLH.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.FixedEnergyLLH.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.FixedEnergyLLH.calculate_test_statistic">
<code class="descname">calculate_test_statistic</code><span class="sig-paren">(</span><em>params</em>, <em>weights</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#FixedEnergyLLH.calculate_test_statistic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.FixedEnergyLLH.calculate_test_statistic" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the test statistic, given the parameters. Uses numexpr
for faster calculations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> – Parameters from Minimisation</li>
<li><strong>weights</strong> – Normalised fraction of n_s allocated to each source</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">2 * llh value (Equal to Test Statistic)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.FixedEnergyLLH.create_acceptance_function">
<code class="descname">create_acceptance_function</code><span class="sig-paren">(</span><em>acc_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#FixedEnergyLLH.create_acceptance_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.FixedEnergyLLH.create_acceptance_function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.FixedEnergyLLH.create_energy_functions">
<code class="descname">create_energy_functions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#FixedEnergyLLH.create_energy_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.FixedEnergyLLH.create_energy_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the acceptance function, which parameterises signal
acceptance as a function of declination, and the energy weighting
function, which gives the energy signal-over-background ratio</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Acceptance function, energy_weighting_function</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.FixedEnergyLLH.create_energy_weighting_function">
<code class="descname">create_energy_weighting_function</code><span class="sig-paren">(</span><em>SoB_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#FixedEnergyLLH.create_energy_weighting_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.FixedEnergyLLH.create_energy_weighting_function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.FixedEnergyLLH.create_kwargs">
<code class="descname">create_kwargs</code><span class="sig-paren">(</span><em>data</em>, <em>pull_corrector</em>, <em>weight_f=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#FixedEnergyLLH.create_kwargs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.FixedEnergyLLH.create_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a likelihood function to minimise, based on the dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> – Dataset</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">LLH function that can be minimised</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flarestack.core.llh.FixedEnergyLLH.fit_energy">
<code class="descname">fit_energy</code><em class="property"> = False</em><a class="headerlink" href="#flarestack.core.llh.FixedEnergyLLH.fit_energy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.llh.LLH">
<em class="property">class </em><code class="descclassname">flarestack.core.llh.</code><code class="descname">LLH</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class LLH.</p>
<dl class="method">
<dt id="flarestack.core.llh.LLH.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flarestack.core.llh.LLH.assume_background">
<em class="property">static </em><code class="descname">assume_background</code><span class="sig-paren">(</span><em>n_s</em>, <em>n_coincident</em>, <em>n_all</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.assume_background"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.assume_background" title="Permalink to this definition">¶</a></dt>
<dd><p>To save time with likelihood calculation, it can be assumed that
all events defined as “non-coincident”, because of distance in space
and time to the source, are in fact background events. This is
equivalent to setting S=0 for all non-coincident events. IN this
case, the likelihood can be calculated as the product of the number
of non-coincident events, and the likelihood of an event which has S=0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_s</strong> – Array of expected number of events</li>
<li><strong>n_coincident</strong> – Number of events that were not assumed to have S=0</li>
<li><strong>n_all</strong> – The total number of events</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Log Likelihood value for the given</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.LLH.background_pdf">
<code class="descname">background_pdf</code><span class="sig-paren">(</span><em>source</em>, <em>cut_data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.background_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.background_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the value of the background spatial PDF for a given
source for each event in the coincident data subsample. Thus is done
by calling the self.bkg_spline spline function, which was fitted to
the Sin(Declination) distribution of the data.</p>
<p>If there is a signal Time PDF given, then the background time PDF
is also calculated for each event. This is assumed to be a normalised
uniform distribution for the season.</p>
<p>Returns either the background spatial PDF values, or the product of the
background spatial and time PDFs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>source</strong> – Source to be considered</li>
<li><strong>cut_data</strong> – Subset of Dataset with coincident events</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Array of Background Spacetime PDF values</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.LLH.background_spatial">
<code class="descname">background_spatial</code><span class="sig-paren">(</span><em>cut_data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.background_spatial"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.background_spatial" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.LLH.calculate_test_statistic">
<code class="descname">calculate_test_statistic</code><span class="sig-paren">(</span><em>params</em>, <em>weights</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.calculate_test_statistic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.calculate_test_statistic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="flarestack.core.llh.LLH.create">
<em class="property">classmethod </em><code class="descname">create</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.create" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.LLH.create_background_function">
<code class="descname">create_background_function</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.create_background_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.create_background_function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.LLH.create_energy_functions">
<code class="descname">create_energy_functions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.create_energy_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.create_energy_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the acceptance function, which parameterises signal
acceptance as a function of declination, and the energy weighting
function, which gives the energy signal-over-background ratio</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Acceptance function, energy_weighting_function</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.LLH.create_kwargs">
<code class="descname">create_kwargs</code><span class="sig-paren">(</span><em>data</em>, <em>pull_corrector</em>, <em>weight_f=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.create_kwargs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.create_kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.LLH.create_llh_function">
<code class="descname">create_llh_function</code><span class="sig-paren">(</span><em>data</em>, <em>pull_corrector</em>, <em>weight_f=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.create_llh_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.create_llh_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a likelihood function to minimise, based on the dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> – Dataset</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">LLH function that can be minimised</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="flarestack.core.llh.LLH.get_injected_parameters">
<em class="property">classmethod </em><code class="descname">get_injected_parameters</code><span class="sig-paren">(</span><em>mh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.get_injected_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.get_injected_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="flarestack.core.llh.LLH.get_parameters">
<em class="property">classmethod </em><code class="descname">get_parameters</code><span class="sig-paren">(</span><em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.get_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.get_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="flarestack.core.llh.LLH.register_subclass">
<em class="property">classmethod </em><code class="descname">register_subclass</code><span class="sig-paren">(</span><em>llh_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.register_subclass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.register_subclass" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new subclass of EnergyPDF, with class name equal to
“energy_pdf_name”.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flarestack.core.llh.LLH.return_injected_parameters">
<em class="property">static </em><code class="descname">return_injected_parameters</code><span class="sig-paren">(</span><em>mh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.return_injected_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.return_injected_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="flarestack.core.llh.LLH.return_llh_parameters">
<em class="property">static </em><code class="descname">return_llh_parameters</code><span class="sig-paren">(</span><em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.return_llh_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.return_llh_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.LLH.select_spatially_coincident_data">
<code class="descname">select_spatially_coincident_data</code><span class="sig-paren">(</span><em>data</em>, <em>sources</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.select_spatially_coincident_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.select_spatially_coincident_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks each source, and only identifies events in data which are
both spatially and time-coincident with the source. Spatial
coincidence is defined as a +/- 5 degree box centered on the  given
source. Time coincidence is determined by the parameters of the LLH
Time PDF. Produces a mask for the dataset, which removes all events
which are not coincident with at least one source.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> – Dataset to be tested</li>
<li><strong>sources</strong> – Sources to be tested</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Mask to remove</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.LLH.signal_pdf">
<code class="descname">signal_pdf</code><span class="sig-paren">(</span><em>source</em>, <em>cut_data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#LLH.signal_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.LLH.signal_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the value of the signal spatial PDF for a given source
for each event in the coincident data subsample. If there is a Time PDF
given, also calculates the value of the signal Time PDF for each event.
Returns either the signal spatial PDF values, or the product of the
signal spatial and time PDFs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>source</strong> – Source to be considered</li>
<li><strong>cut_data</strong> – Subset of Dataset with coincident events</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Array of Signal Spacetime PDF values</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flarestack.core.llh.LLH.subclasses">
<code class="descname">subclasses</code><em class="property"> = {'fixed_energy': &lt;class 'flarestack.core.llh.FixedEnergyLLH'&gt;, 'spatial': &lt;class 'flarestack.core.llh.SpatialLLH'&gt;, 'standard': &lt;class 'flarestack.core.llh.StandardLLH'&gt;, 'standard_matrix': &lt;class 'flarestack.core.llh.StandardMatrixLLH'&gt;, 'standard_overlapping': &lt;class 'flarestack.core.llh.StandardOverlappingLLH'&gt;}</em><a class="headerlink" href="#flarestack.core.llh.LLH.subclasses" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.llh.SpatialLLH">
<em class="property">class </em><code class="descclassname">flarestack.core.llh.</code><code class="descname">SpatialLLH</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#SpatialLLH"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.SpatialLLH" title="Permalink to this definition">¶</a></dt>
<dd><p>Most basic LLH, in which only spatial, and optionally also temporal,
information is included. No Energy PDF is used, and no energy weighting
is applied.</p>
<dl class="method">
<dt id="flarestack.core.llh.SpatialLLH.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#SpatialLLH.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.SpatialLLH.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.SpatialLLH.calculate_test_statistic">
<code class="descname">calculate_test_statistic</code><span class="sig-paren">(</span><em>params</em>, <em>weights</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#SpatialLLH.calculate_test_statistic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.SpatialLLH.calculate_test_statistic" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the test statistic, given the parameters. Uses numexpr
for faster calculations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> – Parameters from Minimisation</li>
<li><strong>weights</strong> – Normalised fraction of n_s allocated to each source</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">2 * llh value (Equal to Test Statistic)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.SpatialLLH.create_energy_function">
<code class="descname">create_energy_function</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#SpatialLLH.create_energy_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.SpatialLLH.create_energy_function" title="Permalink to this definition">¶</a></dt>
<dd><p>In the most simple case of spatial-only weighting, you would
neglect the energy weighting of events. Then, you can simply assume
that the detector acceptance is roughly proportional to the data rate,
i.e assuming that the incident background atmospheric neutrino flux
is uniform. Thus the acceptance of the detector is simply the
background spatial PDF (which is a spline fitted to data as a
function of declination). This method does, admittedly neglect the
fact that background in the southern hemisphere is mainly composed of
muon bundles, rather than atmospheric neutrinos. Still, it’s slighty
better than assuming a uniform detector acceptance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">1D linear interpolation</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.SpatialLLH.create_llh_function">
<code class="descname">create_llh_function</code><span class="sig-paren">(</span><em>data</em>, <em>pull_corrector</em>, <em>weight_f=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#SpatialLLH.create_llh_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.SpatialLLH.create_llh_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a likelihood function to minimise, based on the dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> – Dataset</li>
<li><strong>pull_corrector</strong> – pull_corrector</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">LLH function that can be minimised</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flarestack.core.llh.SpatialLLH.fit_energy">
<code class="descname">fit_energy</code><em class="property"> = False</em><a class="headerlink" href="#flarestack.core.llh.SpatialLLH.fit_energy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.llh.StandardLLH">
<em class="property">class </em><code class="descclassname">flarestack.core.llh.</code><code class="descname">StandardLLH</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardLLH"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardLLH" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="flarestack.core.llh.StandardLLH.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardLLH.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardLLH.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.StandardLLH.calculate_test_statistic">
<code class="descname">calculate_test_statistic</code><span class="sig-paren">(</span><em>params</em>, <em>weights</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardLLH.calculate_test_statistic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardLLH.calculate_test_statistic" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the test statistic, given the parameters. Uses numexpr
for faster calculations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> – Parameters from Minimisation</li>
<li><strong>weights</strong> – Normalised fraction of n_s allocated to each source</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">2 * llh value (Equal to Test Statistic)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.StandardLLH.create_SoB_energy_cache">
<code class="descname">create_SoB_energy_cache</code><span class="sig-paren">(</span><em>cut_data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardLLH.create_SoB_energy_cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardLLH.create_SoB_energy_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the Log(Signal/Background) values for all coincident
data. For each value of gamma in self.gamma_support_points, calculates
the Log(Signal/Background) values for the coincident data. Then saves
each weight array to a dictionary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cut_data</strong> – Subset of the data containing only coincident events</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Dictionary containing SoB values for each event for each</td>
</tr>
</tbody>
</table>
<p>gamma value.</p>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.StandardLLH.create_acceptance_function">
<code class="descname">create_acceptance_function</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardLLH.create_acceptance_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardLLH.create_acceptance_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 2D linear interpolation of the acceptance of the detector
for the given season, as a function of declination and gamma. Returns
this interpolation function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">2D linear interpolation</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.StandardLLH.create_energy_functions">
<code class="descname">create_energy_functions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardLLH.create_energy_functions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardLLH.create_energy_functions" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the acceptance function, which parameterises signal
acceptance as a function of declination, and the energy weighting
function, which gives the energy signal-over-background ratio</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Acceptance function, energy_weighting_function</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.StandardLLH.create_kwargs">
<code class="descname">create_kwargs</code><span class="sig-paren">(</span><em>data</em>, <em>pull_corrector</em>, <em>weight_f=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardLLH.create_kwargs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardLLH.create_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a likelihood function to minimise, based on the dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> – Dataset</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">LLH function that can be minimised</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.StandardLLH.estimate_energy_weights">
<code class="descname">estimate_energy_weights</code><span class="sig-paren">(</span><em>gamma</em>, <em>energy_SoB_cache</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardLLH.estimate_energy_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardLLH.estimate_energy_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Quickly estimates the value of Signal/Background for Gamma.
Uses pre-calculated values for first and second derivatives.
Uses a Taylor series to estimate S(gamma), unless SoB has already
been calculated for a given gamma.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>gamma</strong> – Spectral Index</li>
<li><strong>energy_SoB_cache</strong> – Weight cache</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Estimated value for S(gamma)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="flarestack.core.llh.StandardLLH.fit_energy">
<code class="descname">fit_energy</code><em class="property"> = True</em><a class="headerlink" href="#flarestack.core.llh.StandardLLH.fit_energy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.StandardLLH.new_acceptance">
<code class="descname">new_acceptance</code><span class="sig-paren">(</span><em>source</em>, <em>params=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardLLH.new_acceptance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardLLH.new_acceptance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the detector acceptance for a given source, using the
2D interpolation of the acceptance as a function of declination and
gamma. If gamma IS NOT being fit, uses the default value of gamma for
weighting (determined in __init__). If gamma IS being fit, it will be
the last entry in the parameter array, and is the acceptance uses
this value.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>source</strong> – Source to be considered</li>
<li><strong>params</strong> – Parameter array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Value for the acceptance of the detector, in the given</p>
</td>
</tr>
</tbody>
</table>
<p>season, for the source</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flarestack.core.llh.StandardLLH.return_injected_parameters">
<em class="property">static </em><code class="descname">return_injected_parameters</code><span class="sig-paren">(</span><em>mh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardLLH.return_injected_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardLLH.return_injected_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="flarestack.core.llh.StandardLLH.return_llh_parameters">
<em class="property">static </em><code class="descname">return_llh_parameters</code><span class="sig-paren">(</span><em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardLLH.return_llh_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardLLH.return_llh_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.llh.StandardMatrixLLH">
<em class="property">class </em><code class="descclassname">flarestack.core.llh.</code><code class="descname">StandardMatrixLLH</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardMatrixLLH"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardMatrixLLH" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="flarestack.core.llh.StandardMatrixLLH.create_kwargs">
<code class="descname">create_kwargs</code><span class="sig-paren">(</span><em>data</em>, <em>pull_corrector</em>, <em>weight_f=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardMatrixLLH.create_kwargs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardMatrixLLH.create_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a likelihood function to minimise, based on the dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> – Dataset</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">LLH function that can be minimised</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flarestack.core.llh.StandardOverlappingLLH">
<em class="property">class </em><code class="descclassname">flarestack.core.llh.</code><code class="descname">StandardOverlappingLLH</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardOverlappingLLH"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardOverlappingLLH" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="flarestack.core.llh.StandardOverlappingLLH.calculate_test_statistic">
<code class="descname">calculate_test_statistic</code><span class="sig-paren">(</span><em>params</em>, <em>weights</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardOverlappingLLH.calculate_test_statistic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardOverlappingLLH.calculate_test_statistic" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the test statistic, given the parameters. Uses numexpr
for faster calculations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> – Parameters from Minimisation</li>
<li><strong>weights</strong> – Normalised fraction of n_s allocated to each source</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">2 * llh value (Equal to Test Statistic)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="flarestack.core.llh.StandardOverlappingLLH.create_kwargs">
<code class="descname">create_kwargs</code><span class="sig-paren">(</span><em>data</em>, <em>pull_corrector</em>, <em>weight_f=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#StandardOverlappingLLH.create_kwargs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.StandardOverlappingLLH.create_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a likelihood function to minimise, based on the dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> – Dataset</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">LLH function that can be minimised</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="flarestack.core.llh.generate_dynamic_flare_class">
<code class="descclassname">flarestack.core.llh.</code><code class="descname">generate_dynamic_flare_class</code><span class="sig-paren">(</span><em>season</em>, <em>sources</em>, <em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#generate_dynamic_flare_class"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.generate_dynamic_flare_class" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="flarestack.core.llh.read_llh_dict">
<code class="descclassname">flarestack.core.llh.</code><code class="descname">read_llh_dict</code><span class="sig-paren">(</span><em>llh_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/core/llh.html#read_llh_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.core.llh.read_llh_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensures that llh dictionaries remain backwards-compatible</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>llh_dict</strong> – LLH Dictionary</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">LLH Dictionary compatible with new format</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="utils">
<h2>Utils<a class="headerlink" href="#utils" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-flarestack.icecube_utils.dataset_loader">
<span id="icecube-utils"></span><h3>IceCube Utils<a class="headerlink" href="#module-flarestack.icecube_utils.dataset_loader" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="flarestack.icecube_utils.dataset_loader.convert_grl">
<code class="descclassname">flarestack.icecube_utils.dataset_loader.</code><code class="descname">convert_grl</code><span class="sig-paren">(</span><em>season</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/icecube_utils/dataset_loader.html#convert_grl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.icecube_utils.dataset_loader.convert_grl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="flarestack.icecube_utils.dataset_loader.data_loader">
<code class="descclassname">flarestack.icecube_utils.dataset_loader.</code><code class="descname">data_loader</code><span class="sig-paren">(</span><em>data_path</em>, <em>floor=True</em>, <em>cut_fields=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/icecube_utils/dataset_loader.html#data_loader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.icecube_utils.dataset_loader.data_loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to load data for a given season/set of season.
Adds sinDec field if this is not available, and combines multiple years
of data is appropriate (different sets of data from the same icecube
configuration should be given as a list)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data_path</strong> – Path to data or list of paths to data</li>
<li><strong>cut_fields</strong> – Boolean to remove unused fields from datasets on loading</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Loaded Dataset (experimental or MC)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="flarestack.icecube_utils.dataset_loader.grl_loader">
<code class="descclassname">flarestack.icecube_utils.dataset_loader.</code><code class="descname">grl_loader</code><span class="sig-paren">(</span><em>season</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/icecube_utils/dataset_loader.html#grl_loader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.icecube_utils.dataset_loader.grl_loader" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="flarestack.icecube_utils.dataset_loader.verify_grl_with_data">
<code class="descclassname">flarestack.icecube_utils.dataset_loader.</code><code class="descname">verify_grl_with_data</code><span class="sig-paren">(</span><em>seasons</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flarestack/icecube_utils/dataset_loader.html#verify_grl_with_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flarestack.icecube_utils.dataset_loader.verify_grl_with_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<span class="target" id="module-flarestack.utils"></span></div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">Flarestack</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Robert Stein.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>